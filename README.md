# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


# Архитектура Проекта

## Архитектурный Шаблон: Model-View-Presenter (MVP)

### 1. **Model**:
- **Описание:** Модели в MVP отвечают за бизнес-логику и обработку данных приложения. Они независимы от пользовательского интерфейса и взаимодействуют с источниками данных, такими как базы данных или внешние сервисы.
- **Компоненты:**
  - **Model:**
    - **Назначение:** Базовый класс для создания моделей данных.
    - **Функциональность:** Управление данными (CRUD - создание, чтение, обновление, удаление).
    - **Методы:** `emitChanges(event, data)` – уведомляет подписчиков о изменениях в данных.
  - **AppState:**
    - **Назначение:** Хранит глобальное состояние приложения, такое как данные пользователя, состояние сессии и т.д.
    - **Методы:** `setCatalog(data)`, `setPreview(item)`, `addToBasket(item)`, `removeFromBasket(item)`, `clearBasket()` – методы для управления состоянием приложения.

### 2. **View**:
- **Описание:** View компоненты отвечают за отображение данных моделей в пользовательском интерфейсе. Они реагируют на изменения в моделях и обновляют интерфейс.
- **Компоненты:**
  - **Component (абстрактный базовый класс):**
    - **Функциональность:** Предоставляет базовые методы для работы с DOM, такие как `render()`, `setDisabled(state)`, `setVisible(state)`, и т.д.
  - **Card, Form, Order, Basket, Page:**
    - **Пример (Card):** Отображает информацию о товаре.
    - **Методы (Card):** `setTitle(title)`, `setDescription(desc)`, `setPrice(price)` – методы для установки свойств карточки товара.

### 3. **Presenter**:
- **Описание:** Presenter служит медиатором между Model и View. Он обрабатывает пользовательский ввод, делегирует данные моделям и обновляет представления.
- **Роль:** Взаимодействует с моделями для получения данных и управляет обновлением представлений для отображения этих данных.

### Коммуникация и Управление Событиями
- **EventEmitter:** Используется для организации шаблона "наблюдатель" в приложении.
- **Методы:** `on(event, handler)`, `off(event, handler)`, `emit(event, data)` – методы для подписки на события, отписки от событий и их трансляции.

### Сетевые Запросы и Взаимодействие с API
- **API:** Класс, обеспечивающий взаимодействие с внешними API.
- **Методы:**
  - `get(url)`: Выполняет GET-запрос.
  - `post(url, data)`: Выполняет POST-запрос.
  - `handleResponse(response)`: Обрабатывает ответ сервера, превращая его в удобный для работы формат или обрабатывая ошибки.

### Процесс обновления интерфейса пользователя
- **Пользовательские действия:** Пользователь взаимодействует с представлением, например, кликает на кнопку добавления товара в корзину в компоненте `Card`.
- **Обработка в Presenter:** Событие перехватывается презентером, который запросит изменение данных у модели.
- **Изменение данных в Model:** Модель обрабатывает бизнес-логику (например, добавление товара в корзину) и уведомляет о изменениях через `EventEmitter`.
- **Отклик на изменения в View:** Представление подписано на изменения в модели и обновляет пользовательский интерфейс в соответствии с новым состоянием данных.


#### Основные типы данных

```typescript
// Типы данных для категорий продуктов
export type TProductCategory = 'soft-skill' | 'other' | 'additional' | 'button' | 'hard-skill';

// Типы данных для методов оплаты
export type TPaymentMethod = 'online' | 'cash-on-delivery' | 'credit-card';
```

#### Интерфейсы моделей данных

```typescript
// Интерфейс для описания продукта
export interface IProduct {
    productId: string;
    categoryName: TProductCategory;
    productName: string;
    description: string;
    price: number;
    imageUrl?: string;
    isSelected?: boolean;
}

// Интерфейс для элементов корзины
export interface IBasketItem {
    product: IProduct;
    quantity: number;
    subtotal: number;
}

// Интерфейс для данных корзины
export interface IBasket {
    items: IBasketItem[];
    totalAmount: number;
}

// Интерфейс для формы заказа
export interface IOrderDetails {
    paymentMethod: TPaymentMethod;
    shippingAddress: string;
    contactEmail: string;
    contactPhone: string;
    estimatedDeliveryDate?: Date;
}

// Интерфейс для ответа об успешном оформлении заказа
export interface IOrderConfirmation {
    orderId: string;
    orderTotal: number;
    confirmationMessage: string;
}

// Интерфейс для состояния приложения
export interface IApplicationState {
    productCatalog: IProduct[];
    shoppingBasket: IBasket;
    currentOrder: IOrderDetails | null;
    previewProduct: IProduct | null;
}

// Интерфейс для действий с карточкой товара
export interface IProductCardActions {
    onAddToCart: (productId: string, quantity: number) => void;
    onRemoveFromCart: (productId: string, quantity: number) => void;
}
```

### Безопасность и обработка ошибок
- **Обработка ответов API:** Метод `handleResponse` в классе `API` проверяет статус ответа и, в случае ошибок, генерирует исключение, которое может быть перехвачено и обработано для отображения сообщения об ошибке пользователю.
- **Валидация данных:** Перед отправкой данных на сервер или перед их сохранением в модели, данные проходят валидацию в презентере или модели, чтобы предотвратить сохранение некорректных данных.

### Развитие и масштабирование
- **Добавление новых функций:** Благодаря чёткому разделению ответственности, в систему легко интегрировать новые функции. Например, добавление нового типа платежей требует изменений в `Model` и добавления новых методов в `Presenter` для обработки.
- **Масштабирование:** Приложение может быть масштабировано путём добавления новых модулей или расширения существующих компонентов, не нарушая общую структуру и архитектуру.

